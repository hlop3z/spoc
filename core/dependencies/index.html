
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://hlop3z.github.io/spoc/core/dependencies/">
      
      
        <link rel="prev" href="../importer/">
      
      
        <link rel="next" href="../../advanced/plugins/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Dependency Management - Spoc</title>
      
    
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    <link rel="stylesheet" href="../../css/extra.css" />

    
    
      
    

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dependency-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Spoc" class="md-header__button md-logo" aria-label="Spoc" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spoc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dependency Management
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hlop3z/spoc/tree/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../.." class="md-tabs__link">
          
  
  
  SPOC

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Spoc" class="md-nav__button md-logo" aria-label="Spoc" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Spoc
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hlop3z/spoc/tree/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    SPOC
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    SPOC
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../app-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Dependency Management
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependency Management
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-dependency-management-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Dependency Management Matters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-dependencies-in-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining Dependencies in Schema
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining Dependencies in Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Rules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-dependency-resolution-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How Dependency Resolution Works
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How Dependency Resolution Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-three-module-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Three-Module System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-dependencygraph-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        The DependencyGraph Class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The DependencyGraph Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_nodenode" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_node(node)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_edgefrom_node-to_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_edge(from_node, to_node)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topological_sort" class="md-nav__link">
    <span class="md-ellipsis">
      
        topological_sort()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversed" class="md-nav__link">
    <span class="md-ellipsis">
      
        reversed()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circular-dependency-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Circular Dependency Detection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Circular Dependency Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-circular-dependency" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Circular Dependency
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-detection-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How Detection Works
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependency-resolution-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Resolution Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dependency Resolution Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-linear-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 1: Linear Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-diamond-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 2: Diamond Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-complex-multi-layer-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 3: Complex Multi-Layer Application
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#startup-and-shutdown-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup and Shutdown Order
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Startup and Shutdown Order">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#startup-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup Order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shutdown-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shutdown Order
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-keep-dependencies-minimal" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Keep Dependencies Minimal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-avoid-circular-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Avoid Circular Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-layer-your-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Layer Your Modules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-use-clear-naming-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Use Clear Naming Conventions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-document-complex-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Document Complex Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-test-dependency-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Test Dependency Order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-handle-missing-dependencies-gracefully" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Handle Missing Dependencies Gracefully
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Pitfalls
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Pitfalls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pitfall-1-forgetting-transitive-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 1: Forgetting Transitive Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfall-2-dependency-on-self" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 2: Dependency on Self
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfall-3-implicit-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 3: Implicit Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Usage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-dependency-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Dependency Graphs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle Hooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/workers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/workers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/core-utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/app-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-dependency-management-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Dependency Management Matters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-dependencies-in-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining Dependencies in Schema
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining Dependencies in Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Rules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-dependency-resolution-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How Dependency Resolution Works
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How Dependency Resolution Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-three-module-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Three-Module System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-dependencygraph-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        The DependencyGraph Class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The DependencyGraph Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_nodenode" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_node(node)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_edgefrom_node-to_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_edge(from_node, to_node)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topological_sort" class="md-nav__link">
    <span class="md-ellipsis">
      
        topological_sort()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversed" class="md-nav__link">
    <span class="md-ellipsis">
      
        reversed()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circular-dependency-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Circular Dependency Detection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Circular Dependency Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-circular-dependency" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Circular Dependency
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-detection-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How Detection Works
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependency-resolution-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Resolution Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dependency Resolution Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-linear-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 1: Linear Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-diamond-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 2: Diamond Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-complex-multi-layer-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example 3: Complex Multi-Layer Application
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#startup-and-shutdown-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup and Shutdown Order
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Startup and Shutdown Order">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#startup-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup Order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shutdown-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shutdown Order
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-keep-dependencies-minimal" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Keep Dependencies Minimal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-avoid-circular-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Avoid Circular Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-layer-your-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Layer Your Modules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-use-clear-naming-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Use Clear Naming Conventions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-document-complex-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Document Complex Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-test-dependency-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Test Dependency Order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-handle-missing-dependencies-gracefully" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Handle Missing Dependencies Gracefully
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Pitfalls
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Pitfalls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pitfall-1-forgetting-transitive-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 1: Forgetting Transitive Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfall-2-dependency-on-self" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 2: Dependency on Self
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfall-3-implicit-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pitfall 3: Implicit Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Usage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-dependency-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Dependency Graphs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="dependency-management">Dependency Management</h1>
<p>SPOC's dependency management system ensures modules are loaded in the correct order, preventing initialization failures and runtime errors. This guide explains how SPOC resolves dependencies, detects circular dependencies, and provides best practices for structuring your application.</p>
<hr />
<h2 id="why-dependency-management-matters">Why Dependency Management Matters</h2>
<p>In modular applications, components often depend on each other. For example:</p>
<ul>
<li>Views depend on models being loaded first</li>
<li>Services depend on database connections being established</li>
<li>API handlers depend on authentication middleware</li>
</ul>
<p>Without proper dependency management, you might encounter:</p>
<ul>
<li><strong>Initialization Errors</strong>: Accessing undefined modules or resources</li>
<li><strong>Runtime Failures</strong>: Missing dependencies causing crashes</li>
<li><strong>Unpredictable Behavior</strong>: Different initialization order in different runs</li>
</ul>
<p>SPOC's dependency graph ensures deterministic, correct initialization order automatically.</p>
<hr />
<h2 id="defining-dependencies-in-schema">Defining Dependencies in Schema</h2>
<p>Dependencies are declared in the <code>Schema</code> object when creating your framework:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">spoc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Framework</span><span class="p">,</span> <span class="n">Schema</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="c1"># List all modules to load</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="c1"># Define dependencies between modules</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>         <span class="c1"># views depends on models</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">]</span>  <span class="c1"># services depends on both</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="p">}</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">framework</span> <span class="o">=</span> <span class="n">Framework</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">base_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">)</span>
</code></pre></div>
<h3 id="dependency-rules">Dependency Rules</h3>
<ol>
<li><strong>Key</strong>: The module that has dependencies</li>
<li><strong>Value</strong>: List of modules it depends on</li>
<li><strong>Resolution</strong>: SPOC loads dependencies before dependents</li>
<li><strong>Transitive</strong>: Dependencies are resolved recursively</li>
</ol>
<hr />
<h2 id="how-dependency-resolution-works">How Dependency Resolution Works</h2>
<p>SPOC uses a <strong>Directed Acyclic Graph (DAG)</strong> with topological sorting to determine the correct initialization order.</p>
<h3 id="example-three-module-system">Example: Three-Module System</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">]</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Dependency Graph:</strong></p>
<pre class="mermaid"><code>graph LR
    models[models] --&gt; views[views]
    models --&gt; services[services]
    views --&gt; services

    style models fill:#e1f5ff
    style views fill:#fff4e1
    style services fill:#ffe1f5</code></pre>
<p><strong>Initialization Order:</strong></p>
<pre class="mermaid"><code>sequenceDiagram
    participant Framework
    participant Models
    participant Views
    participant Services

    Framework-&gt;&gt;Models: 1. Load &amp; Initialize
    Models--&gt;&gt;Framework: Ready
    Framework-&gt;&gt;Views: 2. Load &amp; Initialize
    Views--&gt;&gt;Framework: Ready
    Framework-&gt;&gt;Services: 3. Load &amp; Initialize
    Services--&gt;&gt;Framework: Ready

    Note over Framework: All modules loaded in correct order</code></pre>
<p><strong>Result</strong>: <code>models</code>  <code>views</code>  <code>services</code></p>
<hr />
<h2 id="the-dependencygraph-class">The DependencyGraph Class</h2>
<p>SPOC's dependency resolution is powered by the <code>DependencyGraph</code> class in <code>spoc.core.utils</code>.</p>
<h3 id="core-methods">Core Methods</h3>
<h4 id="add_nodenode"><code>add_node(node)</code></h4>
<p>Adds a node to the graph representing a module.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">spoc.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DependencyGraph</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">graph</span> <span class="o">=</span> <span class="n">DependencyGraph</span><span class="p">[</span><span class="nb">str</span><span class="p">]()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;views&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="add_edgefrom_node-to_node"><code>add_edge(from_node, to_node)</code></h4>
<p>Creates a directed edge from one node to another, indicating that <code>to_node</code> depends on <code>from_node</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># views depends on models</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># services depends on both models and views</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="topological_sort"><code>topological_sort()</code></h4>
<p>Performs topological sort to determine initialization order.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Returns modules in dependency order</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">order</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1"># Result: [&quot;models&quot;, &quot;views&quot;, &quot;services&quot;]</span>
</code></pre></div>
<p><strong>Algorithm</strong>: Uses Kahn's algorithm with in-degree calculation.</p>
<p><strong>Time Complexity</strong>: O(V + E) where V = vertices (modules), E = edges (dependencies)</p>
<h4 id="reversed"><code>reversed()</code></h4>
<p>Creates a new graph with all edges reversed, used for shutdown order.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Reverse the graph for shutdown</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">shutdown_graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">reversed</span><span class="p">()</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">shutdown_order</span> <span class="o">=</span> <span class="n">shutdown_graph</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Result: [&quot;services&quot;, &quot;views&quot;, &quot;models&quot;]</span>
</code></pre></div>
<hr />
<h2 id="circular-dependency-detection">Circular Dependency Detection</h2>
<p>SPOC automatically detects circular dependencies and raises <code>CircularDependencyError</code> with a detailed error message.</p>
<h3 id="example-circular-dependency">Example: Circular Dependency</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">],</span>  <span class="c1"># Creates a cycle!</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;views&quot;</span><span class="p">]</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="p">}</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c1"># This will raise CircularDependencyError</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="n">framework</span> <span class="o">=</span> <span class="n">Framework</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>
<p><strong>Problem Visualization:</strong></p>
<pre class="mermaid"><code>graph LR
    models[models] --&gt; services[services]
    services --&gt; views[views]
    views --&gt; models

    style models fill:#ffcccc
    style views fill:#ffcccc
    style services fill:#ffcccc</code></pre>
<p><strong>Error Message:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>CircularDependencyError: Circular dependency detected: models -&gt; services -&gt; views -&gt; models
</code></pre></div>
<h3 id="how-detection-works">How Detection Works</h3>
<p>During <code>topological_sort()</code>:</p>
<ol>
<li>Calculate in-degree for each node</li>
<li>Process nodes with in-degree of 0</li>
<li>If unprocessed nodes remain, a cycle exists</li>
<li>Perform depth-first search to identify the exact cycle</li>
<li>Raise <code>CircularDependencyError</code> with cycle path</li>
</ol>
<hr />
<h2 id="dependency-resolution-examples">Dependency Resolution Examples</h2>
<h3 id="example-1-linear-dependencies">Example 1: Linear Dependencies</h3>
<p>Simple chain where each module depends on the previous one.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">,</span> <span class="s2">&quot;api&quot;</span><span class="p">],</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        <span class="s2">&quot;api&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">]</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    <span class="p">}</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Graph:</strong></p>
<pre class="mermaid"><code>graph LR
    database[database] --&gt; models[models]
    models --&gt; services[services]
    services --&gt; api[api]

    style database fill:#e1f5ff
    style models fill:#fff4e1
    style services fill:#ffe1f5
    style api fill:#e1ffe1</code></pre>
<p><strong>Initialization Order</strong>: <code>database</code>  <code>models</code>  <code>services</code>  <code>api</code></p>
<p><strong>Shutdown Order</strong>: <code>api</code>  <code>services</code>  <code>models</code>  <code>database</code></p>
<hr />
<h3 id="example-2-diamond-dependencies">Example 2: Diamond Dependencies</h3>
<p>Multiple modules depend on a common base module.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">,</span> <span class="s2">&quot;api&quot;</span><span class="p">],</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>        <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="s2">&quot;api&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">]</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="p">}</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Graph:</strong></p>
<pre class="mermaid"><code>graph TD
    database[database] --&gt; models[models]
    database --&gt; cache[cache]
    models --&gt; api[api]
    cache --&gt; api

    style database fill:#e1f5ff
    style models fill:#fff4e1
    style cache fill:#fff4e1
    style api fill:#ffe1f5</code></pre>
<p><strong>Possible Initialization Orders:</strong></p>
<ul>
<li><code>database</code>  <code>models</code>  <code>cache</code>  <code>api</code></li>
<li><code>database</code>  <code>cache</code>  <code>models</code>  <code>api</code></li>
</ul>
<p>Both are valid. SPOC guarantees <code>database</code> loads first and <code>api</code> loads last.</p>
<hr />
<h3 id="example-3-complex-multi-layer-application">Example 3: Complex Multi-Layer Application</h3>
<p>Real-world application with multiple layers and dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>        <span class="s2">&quot;config&quot;</span><span class="p">,</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        <span class="s2">&quot;database&quot;</span><span class="p">,</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>        <span class="s2">&quot;cache&quot;</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="s2">&quot;models&quot;</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="s2">&quot;repositories&quot;</span><span class="p">,</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="s2">&quot;services&quot;</span><span class="p">,</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>        <span class="s2">&quot;middleware&quot;</span><span class="p">,</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        <span class="s2">&quot;views&quot;</span><span class="p">,</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="s2">&quot;api&quot;</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="p">],</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">],</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">],</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>        <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>        <span class="s2">&quot;repositories&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repositories&quot;</span><span class="p">],</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>        <span class="s2">&quot;middleware&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>        <span class="s2">&quot;api&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;middleware&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">]</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>    <span class="p">}</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Graph:</strong></p>
<pre class="mermaid"><code>graph TD
    config[config] --&gt; database[database]
    config --&gt; cache[cache]
    database --&gt; models[models]
    models --&gt; repositories[repositories]
    cache --&gt; repositories
    repositories --&gt; services[services]
    services --&gt; middleware[middleware]
    services --&gt; views[views]
    middleware --&gt; api[api]
    views --&gt; api

    style config fill:#e1f5ff
    style database fill:#fff4e1
    style cache fill:#fff4e1
    style models fill:#ffe1f5
    style repositories fill:#e1ffe1
    style services fill:#e1f5ff
    style middleware fill:#fff4e1
    style views fill:#fff4e1
    style api fill:#ffe1f5</code></pre>
<p><strong>Initialization Flow:</strong></p>
<pre class="mermaid"><code>flowchart TD
    Start([Framework Startup]) --&gt; Load1[Load: config]
    Load1 --&gt; Load2[Load: database, cache]
    Load2 --&gt; Load3[Load: models]
    Load3 --&gt; Load4[Load: repositories]
    Load4 --&gt; Load5[Load: services]
    Load5 --&gt; Load6[Load: middleware, views]
    Load6 --&gt; Load7[Load: api]
    Load7 --&gt; Done([Ready])

    style Start fill:#e1f5ff
    style Done fill:#e1ffe1</code></pre>
<hr />
<h2 id="startup-and-shutdown-order">Startup and Shutdown Order</h2>
<p>SPOC ensures proper initialization and cleanup by using the dependency graph in both directions.</p>
<h3 id="startup-order">Startup Order</h3>
<p>Modules are initialized in <strong>dependency order</strong> (leaves to root):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">framework</span> <span class="o">=</span> <span class="n">Framework</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1"># Automatically calls startup()</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># Internally:</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># 1. Build dependency graph</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1"># 2. Perform topological sort</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c1"># 3. Load modules in order: models  views  services</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c1"># 4. Call initialize() on each module</span>
</code></pre></div>
<h3 id="shutdown-order">Shutdown Order</h3>
<p>Modules are torn down in <strong>reverse dependency order</strong> (root to leaves):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">framework</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># Internally:</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># 1. Reverse the dependency graph</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># 2. Perform topological sort on reversed graph</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># 3. Teardown modules in order: services  views  models</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># 4. Call teardown() on each module</span>
</code></pre></div>
<p><strong>Example:</strong></p>
<pre class="mermaid"><code>sequenceDiagram
    participant Framework
    participant Models
    participant Views
    participant Services

    Note over Framework,Services: STARTUP
    Framework-&gt;&gt;Models: initialize()
    Framework-&gt;&gt;Views: initialize()
    Framework-&gt;&gt;Services: initialize()

    Note over Framework,Services: Application runs...

    Note over Framework,Services: SHUTDOWN
    Framework-&gt;&gt;Services: teardown()
    Framework-&gt;&gt;Views: teardown()
    Framework-&gt;&gt;Models: teardown()</code></pre>
<hr />
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-keep-dependencies-minimal">1. Keep Dependencies Minimal</h3>
<p>Only declare dependencies you actually need.</p>
<p><strong>Bad:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># views doesn&#39;t actually use services</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Good:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Minimal dependencies</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="p">}</span>
</code></pre></div>
<h3 id="2-avoid-circular-dependencies">2. Avoid Circular Dependencies</h3>
<p>Design your architecture to prevent circular dependencies.</p>
<p><strong>Bad:</strong></p>
<pre class="mermaid"><code>graph LR
    models[models] --&gt; services[services]
    services --&gt; models

    style models fill:#ffcccc
    style services fill:#ffcccc</code></pre>
<p><strong>Good:</strong></p>
<pre class="mermaid"><code>graph LR
    models[models] --&gt; repositories[repositories]
    repositories --&gt; services[services]

    style models fill:#e1f5ff
    style repositories fill:#fff4e1
    style services fill:#ffe1f5</code></pre>
<h3 id="3-layer-your-modules">3. Layer Your Modules</h3>
<p>Follow a layered architecture:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>Data Layer (models, database)
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>Logic Layer (repositories, services)
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>Presentation Layer (views, api)
</code></pre></div>
<p><strong>Implementation:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;repositories&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;api&quot;</span><span class="p">],</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>        <span class="c1"># Data layer</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>        <span class="s2">&quot;repositories&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>        <span class="c1"># Logic layer</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repositories&quot;</span><span class="p">],</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>        <span class="c1"># Presentation layer</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>        <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>        <span class="s2">&quot;api&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;services&quot;</span><span class="p">]</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>    <span class="p">}</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="p">)</span>
</code></pre></div>
<h3 id="4-use-clear-naming-conventions">4. Use Clear Naming Conventions</h3>
<p>Name modules to reflect their layer and purpose:</p>
<ul>
<li><code>database.py</code> - Database connections</li>
<li><code>models.py</code> - Data models</li>
<li><code>repositories.py</code> - Data access layer</li>
<li><code>services.py</code> - Business logic</li>
<li><code>views.py</code> - Presentation logic</li>
<li><code>api.py</code> - API endpoints</li>
</ul>
<h3 id="5-document-complex-dependencies">5. Document Complex Dependencies</h3>
<p>For complex applications, document why dependencies exist:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">,</span> <span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">],</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        <span class="c1"># services needs models for data structures</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        <span class="c1"># services needs cache for performance optimization</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">]</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="p">}</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="p">)</span>
</code></pre></div>
<h3 id="6-test-dependency-order">6. Test Dependency Order</h3>
<p>Write tests to verify initialization order:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">spoc.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DependencyGraph</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_dependency_order</span><span class="p">():</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">graph</span> <span class="o">=</span> <span class="n">DependencyGraph</span><span class="p">[</span><span class="nb">str</span><span class="p">]()</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;views&quot;</span><span class="p">)</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">)</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;views&quot;</span><span class="p">,</span> <span class="s2">&quot;services&quot;</span><span class="p">)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>    <span class="n">order</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>    <span class="c1"># Verify models loads first</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>    <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;views&quot;</span><span class="p">)</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>    <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;services&quot;</span><span class="p">)</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>    <span class="c1"># Verify services loads last</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>    <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;services&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;views&quot;</span><span class="p">)</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>    <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;services&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="7-handle-missing-dependencies-gracefully">7. Handle Missing Dependencies Gracefully</h3>
<p>Use <code>mode="loose"</code> for optional dependencies:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Strict mode - all modules must exist</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">framework</span> <span class="o">=</span> <span class="n">Framework</span><span class="p">(</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="n">base_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span>  <span class="c1"># Raises error if module missing</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="p">)</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1"># Loose mode - allows missing modules</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">framework</span> <span class="o">=</span> <span class="n">Framework</span><span class="p">(</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    <span class="n">base_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;loose&quot;</span>  <span class="c1"># Skips missing modules</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="common-pitfalls">Common Pitfalls</h2>
<h3 id="pitfall-1-forgetting-transitive-dependencies">Pitfall 1: Forgetting Transitive Dependencies</h3>
<p><strong>Problem</strong>: Not declaring indirect dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># services uses repositories, which uses models</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1"># But you only declare direct dependency</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="s2">&quot;repositories&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repositories&quot;</span><span class="p">]</span>  <span class="c1"># Missing models!</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Solution</strong>: SPOC handles transitive dependencies automatically. Just declare direct dependencies:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>    <span class="s2">&quot;repositories&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">],</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>    <span class="s2">&quot;services&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repositories&quot;</span><span class="p">]</span>  <span class="c1"># SPOC knows services needs models</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="p">}</span>
</code></pre></div>
<h3 id="pitfall-2-dependency-on-self">Pitfall 2: Dependency on Self</h3>
<p><strong>Problem</strong>: Module depending on itself.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>    <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span>  <span class="c1"># Invalid!</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Solution</strong>: Remove self-dependencies. They're always errors.</p>
<h3 id="pitfall-3-implicit-dependencies">Pitfall 3: Implicit Dependencies</h3>
<p><strong>Problem</strong>: Using imports without declaring dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># views.py</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>  <span class="c1"># Implicit dependency!</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c1"># But schema doesn&#39;t declare it</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{}</span>  <span class="c1"># Missing: &quot;views&quot;: [&quot;models&quot;]</span>
</code></pre></div>
<p><strong>Solution</strong>: Always declare dependencies explicitly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">dependencies</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>    <span class="s2">&quot;views&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span>  <span class="c1"># Explicit dependency</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="advanced-usage">Advanced Usage</h2>
<h3 id="custom-dependency-graphs">Custom Dependency Graphs</h3>
<p>Create custom dependency graphs for specialized use cases:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">spoc.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DependencyGraph</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># Build a custom task dependency graph</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">tasks</span> <span class="o">=</span> <span class="n">DependencyGraph</span><span class="p">[</span><span class="nb">str</span><span class="p">]()</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="n">tasks</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;fetch_data&quot;</span><span class="p">,</span> <span class="s2">&quot;process_data&quot;</span><span class="p">)</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">tasks</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;process_data&quot;</span><span class="p">,</span> <span class="s2">&quot;save_results&quot;</span><span class="p">)</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">tasks</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;fetch_data&quot;</span><span class="p">,</span> <span class="s2">&quot;log_activity&quot;</span><span class="p">)</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c1"># Get execution order</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="n">execution_order</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="c1"># [&quot;fetch_data&quot;, &quot;process_data&quot;, &quot;log_activity&quot;, &quot;save_results&quot;]</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">execution_order</span><span class="p">:</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running task: </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="dynamic-dependencies">Dynamic Dependencies</h3>
<p>Add dependencies at runtime based on configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_schema</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    <span class="n">modules</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;core&quot;</span><span class="p">,</span> <span class="s2">&quot;api&quot;</span><span class="p">]</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;api&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;core&quot;</span><span class="p">]}</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>    <span class="c1"># Add optional modules based on config</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;enable_cache&quot;</span><span class="p">):</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>        <span class="n">modules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;cache&quot;</span><span class="p">)</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>        <span class="n">dependencies</span><span class="p">[</span><span class="s2">&quot;api&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;core&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">]</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;enable_auth&quot;</span><span class="p">):</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>        <span class="n">modules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;auth&quot;</span><span class="p">)</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>        <span class="n">dependencies</span><span class="p">[</span><span class="s2">&quot;api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;auth&quot;</span><span class="p">)</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>    <span class="k">return</span> <span class="n">Schema</span><span class="p">(</span><span class="n">modules</span><span class="o">=</span><span class="n">modules</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="n">dependencies</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="summary">Summary</h2>
<p>SPOC's dependency management system:</p>
<ul>
<li><strong>Ensures correct initialization order</strong> using topological sorting</li>
<li><strong>Detects circular dependencies</strong> automatically with detailed error messages</li>
<li><strong>Handles shutdown properly</strong> by reversing the dependency graph</li>
<li><strong>Supports complex architectures</strong> with multi-layer dependencies</li>
<li><strong>Provides predictable behavior</strong> with deterministic ordering</li>
</ul>
<p>By following best practices and understanding how SPOC resolves dependencies, you can build robust, maintainable applications with confidence that modules will always load in the correct order.</p>
<hr />
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><strong>Learn about Lifecycle Hooks</strong>: <a href="../../advanced/lifecycle/">Lifecycle Hooks Guide</a></li>
<li><strong>Explore the Framework API</strong>: <a href="../../api/framework/">Framework API Reference</a></li>
<li><strong>Study the Importer</strong>: <a href="../importer/">Importer Guide</a></li>
<li><strong>Review Examples</strong>: Check the <code>examples/</code> directory for real-world patterns</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../importer/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Importer">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Importer
              </div>
            </div>
          </a>
        
        
          
          <a href="../../advanced/plugins/" class="md-footer__link md-footer__link--next" aria-label="Next: Plugins">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Plugins
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  hlop3z
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../termynal.js"></script>
      
    

  </body>
</html>